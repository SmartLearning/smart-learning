machine:
    services:
        - docker
    java:
        version: oraclejdk8
    node:
        version: 6.11.0
dependencies:
    cache_directories:
        - app/node
        - app/node_modules
        - app/gradle-cache
        - app/.gradle
        - app/.yarn-cache
        - .gradle
        -  /home/ubuntu/.yarn-cache
    override:
        - java -version
        # Repo for Yarn
        - curl -o- -L https://yarnpkg.com/install.sh | bash
        - export PATH=/home/ubuntu/.yarn/bin:$PATH
        - yarn global add bower gulp-cli gulp
        - cd app/
        - yarn install
test:
    override:
        - cd app/
        - chmod +x gradlew
        - ./gradlew clean test --no-daemon
        - gulp install test
        - ./gradlew bootRepackage -x test --no-daemon
        - ./gradlew deployHeroku --no-daemon
deployment:
    staging:
        branch: develop
        heroku:
            appname: smart-learning